<!-- Add Font Awesome CDN (if not already included) -->
<head>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

{% for icon in icons %}
  <div style="display: flex; align-items: center; justify-content: space-between;">
    <!-- Icon Name and Download Button -->
    <h2 style="margin: 0;">{{ icon.name }}</h2>
    <button
      onclick="downloadSvg('{{ icon.name }}', this)"
      style="padding: 0.5rem; border: none; cursor: pointer; border-radius: 5px; display: flex; align-items: center;">
      <!-- Download Icon (Font Awesome) -->
      <i class="fas fa-download"></i>
    </button>
  </div>

  <div style="display: flex; align-items: flex-start; gap: 2rem;">
    <!-- Left Side: Icon Preview -->
    <div style="flex: 1; text-align: center; position: relative; overflow: hidden; width: 250px; height: 250px;">
      <figure>
        {{ icon.svg|safe }}
      </figure>
    </div>

    <!-- Right Side: Properties -->
    <div style="flex: 1;">
      <h3>Property Mapping</h3>
      <pre style="padding: 25px;">{{ icon.properties|tojson(indent=2) }}</pre>
    </div>
  </div>
  <hr>
{% endfor %}

<!-- JavaScript for Download Functionality -->
<script>
  function downloadSvg(iconName, button) {
    const svgContainer = button.closest('div').nextElementSibling.querySelector('figure'); // The <figure> containing the SVG
    const svgElement = svgContainer.querySelector('svg');
    if (!svgElement) {
      alert('SVG not found!');
      return;
    }

    // Serialize the SVG
    const serializer = new XMLSerializer();
    const svgData = serializer.serializeToString(svgElement);
    const blob = new Blob([svgData], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);

    // Create a temporary download link
    const a = document.createElement('a');
    a.href = url;
    a.download = `${iconName}.svg`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    // Revoke the object URL
    URL.revokeObjectURL(url);
  }
</script>
