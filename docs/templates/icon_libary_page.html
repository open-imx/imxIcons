{% for icon in icons %}
  <h2>{{ icon.name }}</h2>
  <div style="display: flex; align-items: flex-start; gap: 2rem;">
    <!-- Left Side: Icon Preview -->
    <div style="flex: 1; text-align: center; position: relative; overflow: hidden; width: 250px; height: 250px;">
      <!-- Download Button -->
      <button
        style="position: absolute; top: 0; left: 0; background: white; border: 1px solid #ccc; padding: 5px; cursor: pointer; z-index: 10;"
        onclick="downloadSvg('{{ icon.name }}', this)">
        Download
      </button>
      <figure>
        {{ icon.svg|safe }}
      </figure>
    </div>

    <!-- Right Side: Properties -->
    <div style="flex: 1;">
      <h3>Property Mapping</h3>
      <pre style="padding: 25px;">{{ icon.properties|tojson(indent=2) }}</pre>
    </div>
  </div>
  <hr>
{% endfor %}

<!-- JavaScript for Download Functionality -->
<script>
  function downloadSvg(iconName, button) {
    const svgContainer = button.nextElementSibling; // The <figure> containing the SVG
    const svgElement = svgContainer.querySelector('svg');
    if (!svgElement) {
      alert('SVG not found!');
      return;
    }

    // Serialize the SVG
    const serializer = new XMLSerializer();
    const svgData = serializer.serializeToString(svgElement);
    const blob = new Blob([svgData], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);

    // Create a temporary download link
    const a = document.createElement('a');
    a.href = url;
    a.download = `${iconName}.svg`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    // Revoke the object URL
    URL.revokeObjectURL(url);
  }
</script>